<% if !usuario_signed_in? %>
<div class="row">
	<div class="col-md-3">
		<br/>
	</div>
	<div class="col-md-6">
		<div class="alert alert-warning" role="alert">
			<p style="text-align: center">
				Para ver el detalle de una gauchada debes
				<%= link_to "iniciar sesión", new_usuario_session_path%>
			</p>

		</div>
	</div>
	<div class="col-md-3">
		<br/>
	</div>	
</div>
<%end%>

<div class="border-list-div">
	<h1>Listado de Gauchadas</h1>

	<div class="filtros-div" style="overflow: auto">
		<%= form_tag gauchadas_path, :method => 'get' do %>
		<table>
		<tr>
		<td>
		<div style="margin-right: 10px">
			<strong> Título: </strong>
			<br/>
			<%= text_field_tag :titulo, params[:titulo], placeholder: "Ingrese texto para buscar" %>
			</div>
		</td>
		<td>
		<td>
		<div style="">
			<strong> Ubicación: </strong>
			<br/>
			<div class="styled-select">
				<% text_field_tag :ubicacion, params[:ubicacion] %>
				<%= select_tag :ubicacion, options_for_select(opciones_para_ubicacion,params[:ubicacion]), prompt: "Seleccione una ubicación", :style => "height: 30px; border: 0px"%>
			</div>
			</div>
		</td>
		<td>
		<div style="margin-top: 17px; margin-left: 10px">
				<%= submit_tag "Filtrar" , class: 'btn btn-default'%>
		</div>
		</td>
		</tr>
		</table>
		<% end %>
	</div>

	<% @favores.each do |f| %>
	<div class="border-gau-md" style="overflow: auto;">
			<table style="margin-left: 10px;">
			<tr>
			<td>
				<div class="image-container" style="margin-top: 10px">
					<%= image_tag f.foto, title:"FotoGau", class:"img-md"%>
				</div>
			</td>
			<td>
			<div style="display: inline-block; margin-left: 30px; margin-top: 0px">
				<p style="font-size:17px; max-height: 60px; overflow: auto;"><%= f.titulo%></p>
				<p style="font-style: italic; font-size: 12px; color: grey"> Creada el <%= f.created_at.strftime("%d/%m/%Y %H:%M") %> en <%= f.ubicacion %> por <%= link_to Usuario.find(f.usuario_id).nombre.capitalize+" "+Usuario.find(f.usuario_id).apellido.capitalize, usuario_path(:id => f.usuario_id)%></p>
			</div>
			</td>
			</tr>
			</table>
			<div style="float: right; margin-top: -13px">
					<% if usuario_signed_in? %>
					<% if (current_usuario.id == f.usuario_id)%>
						<%= link_to "Eliminar", f, method: :delete, data: {confirm: '¿Esta seguro de eliminar esta gauchada?'}, class: 'btn btn-danger btn-md' %>
					<% end%>
					<%= link_to "Ver Detalle", favor_path(:id => f.id), class: 'btn btn-warning btn-md' %>
					<% else %>
					<%= link_to "Ver Detalle", favor_path(:id => f.id), class: 'btn btn-default btn-md disabled' %>
					<% end %>
			</div>
	</div>
	<% end %>
	<% if @favores.count == 0 %>
		<p style="font-size: 24px; font-style: italic; color: grey; margin-left: 20px; margin-bottom: 20px"> No hay gauchadas para mostrar!</p>
	<% end %>
	<% if usuario_signed_in? %>
		<% if current_usuario.puntos > 0 %>
			<%= link_to "Pedir Gauchada", new_favor_path, class: 'btn btn-success btn-lg' %>
		<% else %>
			<%= link_to "No tienes puntos", new_favor_path, class: 'btn btn-default btn-lg disabled' %>
			<%= link_to "Tienda", compras_path, class: 'btn btn-success btn-lg' %>
		<% end %>
	<% end %>
	<br>
</div>
